{
    "tasks": [
        {
            "type": "cppbuild",
            "label": "C/C++: g++-17 build active file",
            "command": "/usr/bin/g++",
            "args": [
                "-std=gnu++17",
                "-fdiagnostics-color=always",
                "-g",
                //"-fpermissive", // Relax compliance

                "${workspaceFolder}/src/cblk1/main.cpp",
              //   "${workspaceFolder}/src/cblk1/train_host.cpp",

                "-I", "${workspaceFolder}/src",
                "-I", "${workspaceFolder}/include",
                "-I", "${workspaceFolder}/include/hls4csnn1d_bm",
                "-I", "${workspaceFolder}/external",
                "-I", "${workspaceFolder}/external/json/include",
                "-I", "${workspaceFolder}/external/eigen-3.4.0",
                "-I", "${workspaceFolder}/external/HLS_arbitrary_Precision_Types/include",
                "-I", "/opt/tools/Xilinx/2025.1/Vitis/include",
                "-I", "/opt/libtorch-cxx11-abi-shared-with-deps-2.7.1+cu126/libtorch/include",
                "-I", "/opt/libtorch-cxx11-abi-shared-with-deps-2.7.1+cu126/libtorch/include/torch/csrc/api/include",
                
                "-L", "/opt/libtorch-cxx11-abi-shared-with-deps-2.7.1+cu126/libtorch/lib",
                // ── CUDA 12.6 libs ──   ← this is the one you just picked
                "-L/usr/local/cuda-12.6/targets/x86_64-linux/lib", 
                

                "-Wl,--no-as-needed", 
                // "-ltorch_cuda", "-ltorch_cpu", "-lc10", "-lcuda", "-lcudart", "-pthread",
                "-ltorch_cpu", "-lc10", "-pthread",
                
                // ── embed both dirs into the runtime search path ──
                "-Wl,-rpath,/usr/local/cuda-12.6/targets/x86_64-linux/lib",
                "-Wl,-rpath,/opt/libtorch-cxx11-abi-shared-with-deps-2.7.1+cu126/libtorch/lib",
                
              //   "-o", "check_torch",

                
                //"${workspaceFolder}/src/topclass_tb.cpp",
                //"${workspaceFolder}/src/test_hls_math.cpp",
                "-o", "${workspaceFolder}/build/program"
            ],
            "options": {
                "cwd": "${fileDirname}"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Task generated by Debugger."
        }
    ],
    "version": "2.0.0"
}


// {
//   "type": "cppbuild",
//   "label": "C/C++: g++-17 build active file",
//   "command": "/usr/bin/g++",
//   "args": [
//     "-std=gnu++17", "-O2",

//     // 1 ── put the source(s) FIRST
//     "${workspaceFolder}/src/cblk1_train/main.cpp",

//     // 2 ── include paths
//     "-I", "${workspaceFolder}/src",
//     "-I", "${workspaceFolder}/include",
//     "-I", "${workspaceFolder}/include/hls4csnn1d_bm",
//     "-I", "${workspaceFolder}/external",
//     "-I", "${workspaceFolder}/external/json/include",
//     "-I", "${workspaceFolder}/external/eigen-3.4.0",
//     "-I", "${workspaceFolder}/external/HLS_arbitrary_Precision_Types/include",
//     "-I", "/opt/tools/Xilinx/Vitis/2024.2/include",
//     "-I", "/opt/libtorch-cxx11-abi-shared-with-deps-2.7.1+cu126/libtorch/include",
//     "-I", "/opt/libtorch-cxx11-abi-shared-with-deps-2.7.1+cu126/libtorch/include/torch/csrc/api/include",

//     // 3 ── library search paths + libraries AFTER the source
//     "-L", "/opt/libtorch-cxx11-abi-shared-with-deps-2.7.1+cu126/libtorch/lib",
//     "-L", "/usr/local/cuda-12.6/targets/x86_64-linux/lib",

//     "-Wl,--no-as-needed",          // prevents ld from dropping libs
//     "-ltorch_cuda", "-ltorch_cpu", "-lc10",
//     "-lcudart", "-lcuda",
//     "-pthread",

//     // runtime search path so libcudart is found at run-time
//     "-Wl,-rpath,/usr/local/cuda-12.6/targets/x86_64-linux/lib",

//     "-o", "${workspaceFolder}/build/program"
//   ],
// "options": {
//               "cwd": "${fileDirname}"
// },
// "problemMatcher": [
//               "$gcc"
// ],
// "group": {
//               "kind": "build",
//               "isDefault": true
// },
// "detail": "Task generated by Debugger."
// }
// ],
// "version": "2.0.0"
// }
